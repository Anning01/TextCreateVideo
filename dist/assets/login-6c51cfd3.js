import{a as E}from"./axios-6304c0c0.js";/* empty css                *//* empty css                  */import"./el-form-item-4ed993c7.js";import{d as C,V as i,C as d,u as B,a4 as I,o as c,b as m,e as n,F as N,i as R,f as l,w as a,a as g,g as U,G as D,O as M,P,I as S,Q as $,a5 as z,t as G}from"./index-7751664a.js";const L={class:"login"},O={class:"login-con"},Q={class:"menu-tab"},T=["onClick"],j=n("label",null,"账号",-1),q=n("label",null,"密码",-1),Z=C({__name:"login",setup(A){const p=i([{txt:"登录",current:!0,type:"login"}]);let b=d("login"),_=d(!0),v=B(),y=t=>{p.forEach(e=>{e.current=!1}),t.current=!0,b.value=t.type};const f=d(),h=(t,e,o)=>{if(e)o();else return o(new Error("用户名不能为空"))},k=(t,e,o)=>{!e||e===""?o(new Error("密码不能为空")):o()},r=i({username:"",password:""});I(r,(t,e)=>{t.username&&t.password&&(_.value=!1)});const w=i({password:[{validator:k,trigger:"blur"}],username:[{validator:h,trigger:"blur"}]}),x=t=>{t&&t.validate(e=>{if(e)E.post("http://8.134.91.58/api/token/",r).then(o=>{localStorage.setItem("token",o.data.access),v.push("/book")}).catch(o=>{D({title:"登录失败",message:"账号或密码错误",type:"error"})});else return!1})};return(t,e)=>{const o=M,u=P,V=S,F=$;return c(),m("div",L,[n("div",O,[n("ul",Q,[(c(!0),m(N,null,R(p,s=>(c(),m("li",{class:z({current:s.current}),key:s.type,onClick:H=>g(y)(s)},G(s.txt),11,T))),128))]),l(F,{ref_key:"ruleFormRef",ref:f,model:r,"status-icon":"",rules:w,class:"demo-ruleForm"},{default:a(()=>[l(u,{prop:"username"},{default:a(()=>[j,l(o,{modelValue:r.username,"onUpdate:modelValue":e[0]||(e[0]=s=>r.username=s),type:"text",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(u,{prop:"password"},{default:a(()=>[q,l(o,{modelValue:r.password,"onUpdate:modelValue":e[1]||(e[1]=s=>r.password=s),type:"password",autocomplete:"off",minlength:"6",maxlength:"15"},null,8,["modelValue"])]),_:1}),l(u,null,{default:a(()=>[l(V,{disabled:g(_),type:"primary",class:"login-btn block",onClick:e[2]||(e[2]=s=>x(f.value))},{default:a(()=>[U(" 登录 ")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])])])}}});export{Z as default};
