import{l as k,a as h}from"./url-a39eeccd.js";/* empty css                *//* empty css                 *//* empty css                  */import"./el-form-item-4ed993c7.js";/* empty css                   *//* empty css                        *//* empty css                  *//* empty css                  *//* empty css                    */import"./el-tooltip-4ed993c7.js";import{u as M}from"./index-0d3abda7.js";import{d as P,o as y,c as I,w as l,e as b,f as e,g as v,a as d,O as R,P as W,T as O,U as G,Q as K,I as Q,M as X,C as u,V as me,D as _e,b as B,F as A,i as L,t as ce,G as w,W as ge,R as fe,K as ve,L as be,N as Ve,X as we,p as ke,k as he,S as ye,_ as Ce}from"./index-4415bc37.js";const Ee=b("p",null,"注意：【正向提示词】和【反向提示词】需要输入英文，多个提示词使用逗号隔开",-1),Ue={class:"dialog-footer"},x="140px",Se=P({__name:"tagsUpdate",setup(C){const{tags:n}=M(),z=()=>{n.dialogFormVisible=!n.dialogFormVisible,window.location.reload()},_=c=>{k(h.book_prompt_tags+`/${c.id}`,"put",c).then(s=>{n.dialogFormVisible=!n.dialogFormVisible})};return(c,s)=>{const p=R,m=W,V=O,E=G,U=K,g=Q,F=X;return y(),I(F,{modelValue:d(n).dialogFormVisible,"onUpdate:modelValue":s[5]||(s[5]=i=>d(n).dialogFormVisible=i),title:"标签信息"},{footer:l(()=>[b("span",Ue,[e(g,{onClick:z},{default:l(()=>[v("取消")]),_:1}),e(g,{type:"primary",onClick:s[4]||(s[4]=i=>_(d(n).tags_obj))},{default:l(()=>[v(" 修改 ")]),_:1})])]),default:l(()=>[e(U,{model:d(n).tags_obj},{default:l(()=>[e(m,{label:"书名","label-width":x},{default:l(()=>[e(p,{modelValue:d(n).tags_obj.name,"onUpdate:modelValue":s[0]||(s[0]=i=>d(n).tags_obj.name=i),autocomplete:"off",disabled:"true"},null,8,["modelValue"])]),_:1}),e(m,{label:"文本片段","label-width":x},{default:l(()=>[e(p,{modelValue:d(n).tags_obj.content,"onUpdate:modelValue":s[1]||(s[1]=i=>d(n).tags_obj.content=i),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(E,{fill:""},{default:l(()=>[e(V,{type:"warning","show-icon":"",closable:!1},{default:l(()=>[Ee]),_:1}),e(m,{label:"正向提示词","label-width":x},{default:l(()=>[e(p,{modelValue:d(n).tags_obj.prompt,"onUpdate:modelValue":s[2]||(s[2]=i=>d(n).tags_obj.prompt=i),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{label:"反向提示词","label-width":x},{default:l(()=>[e(p,{modelValue:d(n).tags_obj.negative,"onUpdate:modelValue":s[3]||(s[3]=i=>d(n).tags_obj.negative=i),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),H=C=>(ke("data-v-84265c77"),C=C(),he(),C),Fe=H(()=>b("br",null,null,-1)),je=["src"],xe={class:"demo-drawer__content"},ze=H(()=>b("p",null,"注意：【正向提示词】和【反向提示词】需要输入英文，多个提示词使用逗号隔开",-1)),Te={class:"demo-drawer__footer"},$e=P({__name:"tags",setup(C){const{tags:n}=M(),z=u(!1),_=u(!1),c=u(),s=u(1),p=u(10),m=u([]),V=u([]),E=u();let U;const g=u(),F=o=>{o.book_id===null?w({title:"保存失败",message:"请选择书籍",type:"error"}):o.content.length===0?w({title:"保存失败",message:"人物或者场景词不能为空",type:"error"}):o.prompt.length===0&&o.negative.length===0?w({title:"保存失败",message:"正向提示词或者反向提示词不能全空",type:"error"}):(console.log(o),k(h.book_prompt_tags,"post",o).then(t=>{w({title:"保存成功",message:t.data.message,type:"success"}),U=setTimeout(()=>{setTimeout(()=>{},400)},2e3)}),g.value.close(),window.location.reload())},i=o=>{_.value||ge.confirm("是否提交数据").then(()=>{F(r),_.value=!0,U=setTimeout(()=>{setTimeout(()=>{_.value=!1},400)},2e3)}).catch(()=>{g.value.close()})},J=()=>{_.value=!1,z.value=!1,g.value.close(),clearTimeout(U)},D=u(),Y=u(),T=u(!1),r=me({content:"",prompt:"",negative:"",book_id:null}),Z=()=>{T.value=!0},ee=()=>{if(V.value.length>0){const o=V.value.length;k(h.book_prompt_tags,"delete",{id_list:V.value}).then(t=>{w({title:t.data.message,message:`成功删除了${o}条数据`,type:"success"}),window.location.reload()})}else w({title:"删除失败",message:"未选中任何数据",type:"error"})},le=o=>{p.value=o},oe=o=>{s.value=o},te=o=>{n.dialogFormVisible=!n.dialogFormVisible,n.tags_obj=o},ae=o=>{k(h.book_prompt_tags,"get",{},{book_id:o}).then(t=>{m.value=t==null?void 0:t.data})},ne=o=>{V.value=o.map(t=>t.id)};return _e(()=>{k(h.book_prompt_tags,"get").then(o=>{m.value=o==null?void 0:o.data}),k(h.book_class,"get").then(o=>{E.value=o==null?void 0:o.data})}),(o,t)=>{const N=ye,q=fe,S=Q,f=ve,se=be,de=Ve,ie=X,j=W,$=R,ue=O,re=G,pe=K;return y(),B("div",null,[e(q,{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=a=>c.value=a),class:"m-2",placeholder:"Select",size:"large",onChange:t[1]||(t[1]=a=>ae(c.value))},{default:l(()=>[(y(!0),B(A,null,L(E.value,a=>(y(),I(N,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(S,{type:"primary",class:"addButton",onClick:Z},{default:l(()=>[v("新增")]),_:1}),e(se,{onSelectionChange:ne,data:m.value.slice((s.value-1)*p.value,s.value*p.value),border:"",style:{width:"100%"}},{default:l(()=>[e(f,{type:"selection",width:"55"}),e(f,{prop:"id",label:"编号",width:"55"}),e(f,{prop:"name","show-overflow-tooltip":"true",effect:"light",label:"书名"}),e(f,{prop:"content","show-overflow-tooltip":"true",label:"人物或者场景词"}),e(f,{prop:"prompt","show-overflow-tooltip":"true",label:"正向提示词"}),e(f,{prop:"negative","show-overflow-tooltip":"true",label:"反向提示词"}),e(f,{label:"操作",width:"100"},{default:l(a=>[e(S,{size:"small",onClick:Be=>te(a.row)},{default:l(()=>[v("修改")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(S,{type:"primary",onClick:ee},{default:l(()=>[v("删除")]),_:1}),Fe,e(de,{"current-page":s.value,"page-size":p.value,layout:"total, sizes, prev, pager, next, jumper",total:m.value.length,onSizeChange:le,onCurrentChange:oe},null,8,["current-page","page-size","total"]),e(ie,{modelValue:D.value,"onUpdate:modelValue":t[2]||(t[2]=a=>D.value=a)},{default:l(()=>[b("img",{src:Y.value,style:{width:"100%"}},null,8,je)]),_:1},8,["modelValue"]),e(d(we),{ref_key:"drawerRef",ref:g,modelValue:T.value,"onUpdate:modelValue":t[8]||(t[8]=a=>T.value=a),direction:"btt","before-close":i,size:"55%"},{default:l(()=>[b("div",xe,[e(pe,{model:r},{default:l(()=>[e(j,{label:"请选择所属书籍",required:""},{default:l(()=>[e(q,{modelValue:r.book_id,"onUpdate:modelValue":t[3]||(t[3]=a=>r.book_id=a),placeholder:"请选择所属书籍"},{default:l(()=>[(y(!0),B(A,null,L(E.value,a=>(y(),I(N,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(j,{label:"人物或者场景词",required:""},{default:l(()=>[e($,{modelValue:r.content,"onUpdate:modelValue":t[4]||(t[4]=a=>r.content=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(re,{fill:""},{default:l(()=>[e(ue,{type:"warning","show-icon":"",closable:!1},{default:l(()=>[ze]),_:1}),e(j,{label:"正向提示词",required:""},{default:l(()=>[e($,{modelValue:r.prompt,"onUpdate:modelValue":t[5]||(t[5]=a=>r.prompt=a),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),e(j,{label:"反向提示词"},{default:l(()=>[e($,{modelValue:r.negative,"onUpdate:modelValue":t[6]||(t[6]=a=>r.negative=a),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),b("div",Te,[e(S,{onClick:J},{default:l(()=>[v("取消")]),_:1}),e(S,{type:"primary",loading:_.value,onClick:t[7]||(t[7]=a=>F(r))},{default:l(()=>[v(ce(_.value?"提交中 ...":"提交"),1)]),_:1},8,["loading"])])])]),_:1},8,["modelValue"]),e(Se)])}}});const Qe=Ce($e,[["__scopeId","data-v-84265c77"]]);export{Qe as default};
