import"./axios-6304c0c0.js";/* empty css                   *//* empty css                        *//* empty css                  *//* empty css                  *//* empty css                  *//* empty css                    */import"./el-tooltip-4ed993c7.js";import{l as d,a as o}from"./url-566c741c.js";import{d as A,C as n,D as G,o as w,b as V,f as l,w as i,F as K,i as O,e as C,a as z,g as f,t as Z,G as p,R as q,K as H,I as J,L as Q,N as W,M as X,c as Y,p as ee,k as te,S as ae,_ as le}from"./index-b0380461.js";const oe=u=>(ee("data-v-6c686cb4"),u=u(),te(),u),ne=["src","onClick"],ie=oe(()=>C("br",null,null,-1)),se=["src"],re=A({__name:"pictures",setup(u){const g=n(),c=n(1),_=n(10),m=n([]),s=n([]),k=n(),h=n(),y=n(),b=n(!1),x=n("重绘"),E=e=>{y.value=e,h.value=!0},B=()=>{console.log(s.value),s.value.length>0?d(o.book_pictures_download,"post",{id_list:s.value}).then(e=>{window.open(o.base+e.data.url)}):p({title:"下载失败",message:"未选中任何数据",type:"error"})},D=e=>{_.value=e},I=e=>{c.value=e},N=e=>{window.open(o.base+e.path)},$=e=>{d(o.pictures_redraw,"get",{},{pictures_id:e.id}).then(t=>{t.data.code==200?(p({title:"重绘成功",message:t.data.message,type:"success"}),x.value="重绘中",b.value=!b.value):p({title:"重绘失败",message:t.data.message,type:"error"})})},T=e=>{d(o.book_pictures,"get",{},{book_id:e}).then(t=>{m.value=t==null?void 0:t.data})},F=e=>{s.value=e.map(t=>t.id)};G(()=>{d(o.book_pictures,"get").then(e=>{m.value=e==null?void 0:e.data}),d(o.book_class,"get").then(e=>{k.value=e==null?void 0:e.data})});const P=()=>{if(s.value.length>0){const e=s.value.length;d(o.book_pictures,"delete",{id_list:s.value}).then(t=>{p({title:t.data.message,message:`成功删除了${e}条数据`,type:"success"}),window.location.reload()})}else p({title:"删除失败",message:"未选中任何数据",type:"error"})};return(e,t)=>{const U=ae,L=q,r=H,v=J,M=Q,R=W,j=X;return w(),V("div",null,[l(L,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=a=>g.value=a),class:"m-2",placeholder:"Select",size:"large",onChange:t[1]||(t[1]=a=>T(g.value))},{default:i(()=>[(w(!0),V(K,null,O(k.value,a=>(w(),Y(U,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(M,{onSelectionChange:F,data:m.value.slice((c.value-1)*_.value,c.value*_.value),border:"",style:{width:"100%"}},{default:i(()=>[l(r,{type:"selection",width:"55"}),l(r,{prop:"id",label:"编号",width:"55"}),l(r,{prop:"name","show-overflow-tooltip":"true",effect:"light",label:"书名"}),l(r,{prop:"index",label:"图片顺序"}),l(r,{label:"图片"},{default:i(a=>[C("img",{style:{"max-width":"80px","max-height":"80px"},class:"table-thumb",src:z(o).base+a.row.path,onClick:S=>E(z(o).base+a.row.path)},null,8,ne)]),_:1}),l(r,{label:"操作",width:"150"},{default:i(a=>[l(v,{size:"small",onClick:S=>N(a.row)},{default:i(()=>[f("下载")]),_:2},1032,["onClick"]),l(v,{size:"small",type:"primary",onClick:S=>$(a.row),disabled:b.value,textContent:Z(x.value)},null,8,["onClick","disabled","textContent"])]),_:1})]),_:1},8,["data"]),l(v,{type:"primary",onClick:B},{default:i(()=>[f("下载")]),_:1}),l(v,{type:"danger",onClick:P},{default:i(()=>[f("删除")]),_:1}),ie,l(R,{"current-page":c.value,"page-size":_.value,layout:"total, sizes, prev, pager, next, jumper",total:m.value.length,onSizeChange:D,onCurrentChange:I},null,8,["current-page","page-size","total"]),l(j,{modelValue:h.value,"onUpdate:modelValue":t[2]||(t[2]=a=>h.value=a)},{default:i(()=>[C("img",{src:y.value,style:{width:"100%"}},null,8,se)]),_:1},8,["modelValue"])])}}});const we=le(re,[["__scopeId","data-v-6c686cb4"]]);export{we as default};
